Задание 4.3

Поддерживать сырые логи событий (схема выше). Обратите внимание на то, что данные в этой таблице должны хранится 30 дней.

Построить агрегированную таблицу. Храним агрегаты 180 дней, чтобы делать трендовый анализ:

- уникальные пользователи по event_type и event_date

- сумма потраченных баллов

- количество действий

Сделать Materialized View, которая:

- при вставке данных в таблицу сырых логов событий, будет обновлять агрегированную таблицу

- использует sumState, uniqState, countState

Создать запрос, показывающий:
- Retention: сколько пользователей вернулись в течение следующих 7 дней. Как считается Retention? Гуглим. 

Формат результата - total_users_day_0|returned_in_7_days|retention_7d_percent|

Создать запрос с группировками по быстрой аналитике по дням, формат ниже.

![](https://github.com/DemureLess/stepik_de/blob/main/4/4.3/img/i_4_3_1.png)


## Критерии сдачи задания:

- Созданы 2 таблицы и MV
- Присутствуют 3 state функции, 3 merge функции и сделан - расчет Retention
- Создан запрос на быструю аналитику по дням (через merge)

Корректно оформлен репозиторий. Должен лежать только 1 SQL скрипт-полотно со всеми вашими командами.